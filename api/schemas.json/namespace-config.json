{
  "$id": "http://workfront-apis.dev/schemas/iam/acl/namespace-config.json",
	"$schema": "https://json-schema.org/draft/2019-09/schema",
  "title": "namespace-config",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "description": "A unique name for the namespace. It should match your domain."
    },
    "relations": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "rewrite": {
            "type": "object",
            "oneOf": [{
              "properties": {
                "_this": {
                  "$ref": "#/definitions/operands/_this"
                }
              },
              "required": ["_this"],
              "additionalProperties": false
              
            }, {
              "properties": {
                "computed_userset": {
                 "$ref": "#/definitions/operands/computed_userset" 
                }
              },
              "required": ["computed_userset"],
              "additionalProperties": false
              
            },{
              "properties": {
                "tuple_to_userset": {
	              "$ref": "#/definitions/operands/tuple_to_userset" 
                }
              },
              "required": ["tuple_to_userset"],
              "additionalProperties": false
            }, {
              "properties": {
                "intersection": {
                  "$ref": "#/definitions/operands/intersection"
                }
              },
              "additionalProperties": false
            }, {
              "properties": {
                "union": {
                  "$ref": "#/definitions/operands/union"
                }
              },
              "additionalProperties": false
            }]
          }
        },
        "additionalProperties": false,
        "required": ["name"]
      },
      "minItems": 1
    }
  },
  "required": ["name", "relations"],
  "definitions": {
    "operands": {
      "_this": {
        "type": "object",
        "properties": {},
        "additionalProperties": false
      },
      "computed_userset": {
        "type": "object",
        "properties": {
          "relation": {
            "type": "string"
          }
        },
        "required": ["relation"],
        "additionalProperties": false 
      },
      "tuple_to_userset": {
        "type": "object",
        "properties": {
          "tupleset": {
            "type": "object",
            "properties": {
              "relation": {
                "type": "string"
              }
            },
            "required": ["relation"],
            "additionalProperties": false
          },
          "computed_userset": {
            "$ref": "#/definitions/operands/computed_userset"
          }
        },
        "required": ["tupleset", "computed_userset"],
        "additionalProperties": false
      },
      "intersection": {
        "type": "array",
        "items": {
          "oneOf": [
            {
              "properties": {
                "_this": {
                 "$ref": "#/definitions/operands/_this" 
                }
              },
              "required": ["_this"],
              "additionalProperties": false
            },
            {
              "properties": {
                "computed_userset": {
                 "$ref": "#/definitions/operands/computed_userset" 
                }
              },
              "required": ["computed_userset"],
              "additionalProperties": false
            },
            {
              "properties": {
                "tuple_to_userset": {
                  "$ref": "#/definitions/operands/tuple_to_userset" 
                }
              },
              "required": ["tuple_to_userset"],
              "additionalProperties": false

            },
            {
              "properties": {
                "intersection": {
                  "$ref": "#/definitions/operands/intersection"
                }
              },
              "required": ["intersection"],
              "additionalProperties": false
            },
            {
              "properties": {
                "union": {
                  "$ref": "#/definitions/operands/union"
                }
              },
              "required": ["union"],
              "additionalProperties": false
            }
          ]
        },
        "minItems": 2,
        "uniqueItems": true
      },
      "union": {
        "type": "array",
        "items": {
          "oneOf": [
            {
              "properties": {
                "_this": {
                 "$ref": "#/definitions/operands/_this" 
                }
              },
              "required": ["_this"],
              "additionalProperties": false
            },
            {
              "properties": {
                "computed_userset": {
                 "$ref": "#/definitions/operands/computed_userset" 
                }
              },
              "required": ["computed_userset"],
              "additionalProperties": false
            },
            {
              "properties": {
                "tuple_to_userset": {
                  "$ref": "#/definitions/operands/tuple_to_userset" 
                }
              },
              "required": ["tuple_to_userset"],
              "additionalProperties": false
            },
            {
              "properties": {
                "intersection": {
                  "$ref": "#/definitions/operands/intersection"
                }
              },
              "required": ["intersection"],
              "additionalProperties": false
            },
            {
              "properties": {
                "union": {
                  "$ref": "#/definitions/operands/union"
                }
              },
              "required": ["union"],
              "additionalProperties": false
            }
          ]
        },
        "minItems": 2,
        "uniqueItems": true
      }
    }
  }
}